# 1월 15일의 TIL

## Kotlin - Navigation Component

### 순서

- res/navigation/nav_graph 생성
- mainActivity.xml에 fragment 위젯 추가, .kt에 navigation Controller 생성
- fragment 생성, Controller 연결
- nav_graph에 action 추가
- 버튼 클릭시 리스너 등록

<br>

### mainActivity.xml에 fragment 위젯 추가
```xml
<fragment
        android:id="@+id/nav_host_fragment"
        android:layout_height="0dp"
        android:layout_width="0dp"
        app:navGraph="@navigation/nav_graph"
        app:defaultNavHost="true"
        app:layout_constraintBottom_toBottomOf="parent"
        app:layout_constraintTop_toTopOf="parent"
        app:layout_constraintRight_toRightOf="parent"
        app:layout_constraintLeft_toLeftOf="parent"
        android:name="androidx.navigation.fragment.NavHostFragment"
        />
       
```
`app:defaultNavHost="true"` 하위 프래그먼트들이 들어가게 될 host 임을 선언해준다.

<br>


### .kt에 navigation Controller 생성
`navController = nav_host_fragment.findNavController();`

<br>

### Fragment에 controller 연결
```kt
    lateinit var navController: NavController

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        navController = Navigation.findNavController(view)
    }
```

<br>

### 버튼리스너 달기
1. 람다식으로 버튼 생성
```kt
btn_next.setOnClickListener {
            navController.navigate(R.id.action_mainFragment_to_questionFragment)
        }
```
        
2. 인터페이스로 버튼 생성
```kt
class QuestionFragment : Fragment(), View.OnClickListener {

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

        //인터페이스로 버튼 생성
        btn_next2.setOnClickListener(this)
    }

    override fun onClick(v: View?) {
        // 클릭했을 때 실행되는 메서드
        when(v?.id ){
            R.id.btn_next2 -> {
                navController.navigate(R.id.action_questionFragment_to_selectionFragment)
            }
        }
    }
```


### 프래그먼트간 데이터 전달 - bundle
1. 전송
```kt
    override fun onClick(p0: View?) {
        when(p0?.id){
            R.id.option_1 -> { navigationWithIndex(1)}
            R.id.option_2 -> { navigationWithIndex(2) }
            R.id.option_3 -> { navigationWithIndex(3)}
            R.id.option_4 -> { navigationWithIndex(4)}
            R.id.btn_back -> {
                navController.popBackStack()
            }
        }
    }

    fun navigationWithIndex(index : Int){
        val bundle = bundleOf("index" to index)
        navController.navigate(R.id.action_selectionFragment_to_resultFragment,bundle)
    }
```

2. 받을 때
`option = arguments?.getInt("index") ?: -1`



<br><br>


## 한줄평
자바보다 확실히 직관적이고 간단한거 같긴하다. 익숙하지가 않아서 문제이지만,,,

반복하다보면 익숙해지겠지! 버튼리스너 람다식으로 다는건 진짜 완전 편하다!


