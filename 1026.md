# 10월 26일 TIL
## web : 서버 구축

서버는 24시간 켜져있다 (하지만 요청할 때만 켜지는 서버도 있다)
서버를 24시간동안 켜져있을려면 컴퓨터가 24시간 켜져있어야 하기 때문에 서버를 돌릴 수 있는 컴퓨터들을 임대해주는 곳이 서버를 구축하는 곳!

그래서 우리는 서버에 해당하는 파일을 실행시키고 url로 접속해야한다.

- **client에서 server로 보내는 것들**
    1. url :  어떤 주소를 불러낼지
    2. method : 어떤 방식으로 보낼지 (GET, POST)
    3. param :  어떤 정보를 어떻게 담아서 보낼지 ( ?name=harry, {"name"="harry} )

- **server에서 client로 보내는 것들**
    1. UI : HTML , CSS , javaScript
    2. Data : Json, XML , image

## Flask

파이썬에서 웹을 만들고 서버를 구동시키기 편하게 하는 프레임워크를 ***Flask***라고 한다. 

### 사용하기 위해서

1. 폴더 2개 만들기 ( templates: html파일  , static : css,image 파일)
2. [**app.py**](http://app.py) 만들기 , 통상적으로 이 파일에서 서버를 실행시킨다.

```python
from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello_world():
    return 'Hello World!'

if __name__ == '__main__':
    app.run('0.0.0.0', port=5000, debug=True)
```

- @app.route('/') → 메소드, 동작이 일어날때 불려지는 아이들 얘네들이 함수처럼 많이 생성되어 버튼을 눌렀을때, 데이터를 요청했을때, 등등 상황이 일어났을 때 일을 처리한다.
- app.run() → app.py가 실행될 포트번호와 위치를 설명해준다. 그리고 서버가 실행될때 계속 반복되어 동작하고 있는 부분 .모든 메소드들은 app.run() 위에 있어야 한다. 아래에 있으면 작동 x

### 실행 예제

- **JavaScript에서 통신 보내기**

```jsx
function makeReview() {
            let title = $("#title").val()
            let author = $("#author").val()
            let review = $("#bookReview").val()

            $.ajax({
                type: "POST",
                url: "/review",
                data: {
                    "title_give":title,
                    "author_give":author,
                    "review_give":review
                },
                success: function (response) {
                    if (response["result"] == "success") {
                        alert(response["msg"]);
                        window.location.reload();
                    }
                }
            })
        }
```

javaScript 파일에서 title, author, review 정보를 가져와서 ajax를 통해 "/review" url에 데이터 값들을 POST 방식으로 보내준다. 

이 통신이 성공할 경우 alert 창을 띄워주고 창을 새로고침하게 된다.

클라이언트가 작성한 데이터들을 자바스크립트(ajax)를 이용해 서버로 보내주고 있는 과정이다.

- **Python 에서 서버와 연결**

```python
@app.route('/review', methods=['POST'])
def write_review():
    title_receive = request.form['title_give']
    author_receive = request.form['author_give']
    review_receive = request.form['review_give']

    doc = {
        'title': title_receive,
        'author': author_receive,
        'review': review_receive
    }
    db.reviews.insert_one(doc)

    return jsonify({'result': 'success', 'msg': '리뷰가 작성되었습니다.'})
```

 "/review"  url이 POST 형식으로 보낸 데이터들에 대해 응답하고 그 값들은 DB에 저장해 주는 과정이다. 함수가 성공적으로 실행될 시 msg를 전달한다.

클라이언트에게 전달받은 값들은 서버(DB) 저장 시키는 작업이다.

<br><br>

## 한줄평

ajax 배웠을 때 공공API를 다루는 방법으로 배워서 단순히 이게 공공API를 사용할때만 쓰는 건 줄 알았다.
근데 내가 작성한 코드에섣 API를 부를때도 사용해서 처음에 갑자기ajax를 왜쓰지 싶었는데 알고보니 내가 API를 만든 거 였다!!
공공API처럼 생긴 것들안 API인 줄 알았는데 내가 한 기능기능 구현하는 것들이 API였다... 유레카,,
ajax랑 API개념이 매우 혼란스러워서 더 많이 공부해야 할 것 같다!

<br>
