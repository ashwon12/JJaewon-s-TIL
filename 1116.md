# 11월 16일의 TIL

## aws배포

- **서버 (EC2)에 접속하기**

    ```Shell
    ssh -i keyPair ubuntu@ 서버 IP
    ```

종료할 때는 exit입력해서 내 컴퓨터로 돌아오기

<br>

- **서버에 가상환경 설정하기** 

  1. `python -m venv <가상환경이름> ` 가상환경 만들어주기
  2. `source <가상환경이름>/bin/activate`  가상환경을 활성하는 명령어
  3. `deactivae`` 가상환경 비활성화하는 명령어
  
1번 단계를 입력하고 나면 내가 작성한 가상환경이름으로 된 파일이 생성된다. 

그 파일에 들어가서 환경설정을 해주면 된다.

<br>

- **python, mongoDB 설치**

    ```Bash
    # 파이썬 환경설정

    # python 이라는 명령어로 3 버전 이상을 실행하도록 하는 명령어
    sudo update-alternatives --install /usr/bin/python python /usr/bin/python3 10

    # pip3 설치
    sudo apt-get update
    sudo apt-get install -y python3-pip

    # 버전 확인
    pip3 --version

    # pip3 대신 pip 라고 입력하기 위한 명령어
    # 아래 명령어를 입력하면 pip 라고 쳐도 pip3를 작동시킬 수 있습니다.
    sudo update-alternatives --install /usr/bin/pip pip /usr/bin/pip3 1

    # 가상환경 구축라이브러리 설치
    sudo apt-get install python3-venv -y
    ```

    ```Bash
    # MongoDB 환경설정

    wget -qO - https://www.mongodb.org/static/pgp/server-4.2.asc | sudo apt-key add -

    echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/4.2 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.2.list

    sudo apt-get update

    sudo apt-get install -y mongodb-org
    ```

<br>

- **FIleZilla로 프로젝트 파일 전달시키기**
AWS에 적혀있는 구축한 서버의 IP주소로 연결 시킨 다음 파일을 전달시켜준다.

ubuntu 환경에서 명령어로 전달받은 파일들을 확인하고 `python app.py` 를 통해 서버를 실행시켜준다.

접속은 AWS 보안설정에 등록해놓은 IP주소로 접속하면 된다.

<br>

- **포트번호 없애기 명령어**
    ```bash
    sudo iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 5000
    ```

<br>

- **접속을 끊어도 계속 서버가 실행되게 하는 명령어**

    ```bash 
    nohup python app.py &
    ```
    이렇게 입력하면 서버가 계속 실행된다.

    ```bash
    # 아래 명령어로 미리 pid 값(프로세스 번호)을 본다
    ps -ef | grep 'python'

    # 아래 명령어로 특정 프로세스를 종료시킨다
    kill -9 [pid값]
    ```
    위와 같은 명령어로 서버를 강제종료 할 수 있다.
    
    
    

## 한줄평

이번주 프로젝트 개발을 엄청 빡세게 해 볼 것이다!!!!!!!! 화이팅!!
